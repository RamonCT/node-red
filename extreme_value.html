<script type="text/javascript">
    RED.nodes.registerType('extreme_value',{
      category: 'function',
      color: '#e9967a',
      defaults: {
        name: {value:""},
        mu_day: {value:"0"},
        sigma_day: {value:"1"},
        k_day:{value:"0"},
        tstart_day: {value:"7"},
        tend_day: {value:"19"},
        mu_even: {value:"1"},
        sigma_even: {value:"1"},
        k_even:{value:"5"},
        tstart_even: {value:"19"},
        tend_even: {value:"23"},
        mu_night: {value:"0"},
        sigma_night: {value:"1"},
        k_night:{value:"-0.5"},
        tstart_night: {value:"0"},
        tend_night: {value:"7"},
        layout: {value:'row-spread'}
      },
      inputs:1,
      outputs:1,
      icon: "function.png",
      label: function() {
        return this.name||"extreme_value";
      }
    });
  </script>

  <script type="text/x-red" data-template-name="extreme_value">
    <div class="form-row">
      <label for="node-input-name"><i class="icon-tag"></i> Name</label>
      <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label style="vertical-align: top"><i class="fa fa-th-large"></i> Day </label>
        <div style="display:inline-block">
        <input type="hidden" id="node-input-layout"><input type="hidden" id="node-input-layoutAlign">
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-left">
                <label for="node-input-mu_day"><i class="icon-tag"></i>mu</label>
                <input type="text" id="node-input-mu_day" placeholder="mu">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-center">
                <label for="node-input-sigma_day"><i class="icon-tag"></i>sigma</label>
                <input type="text" id="node-input-sigma_day" placeholder="sigma">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-right">
                <label for="node-input-k_day"><i class="icon-tag"></i>k</label>
                <input type="text" id="node-input-k_day" placeholder="k">
            </a>
        </div>
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-spread">
                <label for="node-input-tstart_day"><i class="icon-tag"></i>t_start</label>
                <input type="text" id="node-input-tstart_day" placeholder="t_start">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-col nr-db-text-layout-col-center">
                <label for="node-input-tend_day"><i class="icon-tag"></i>t_end</label>
                <input type="text" id="node-input-tend_day" placeholder="t_end">
            </a>
        </div>
        </div>
    </div>
    <div class="form-row">
        <label style="vertical-align: top"><i class="fa fa-th-large"></i> Evening </label>
        <div style="display:inline-block">
        <input type="hidden" id="node-input-layout"><input type="hidden" id="node-input-layoutAlign">
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-left">
                <label for="node-input-mu_even"><i class="icon-tag"></i>mu</label>
                <input type="text" id="node-input-mu_even" placeholder="mu">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-center">
                <label for="node-input-sigma_even"><i class="icon-tag"></i>sigma</label>
                <input type="text" id="node-input-sigma_even" placeholder="sigma">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-right">
                <label for="node-input-k_even"><i class="icon-tag"></i>k</label>
                <input type="text" id="node-input-k_even" placeholder="k">
            </a>
        </div>
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-spread">
                <label for="node-input-tstart_even"><i class="icon-tag"></i>t_start</label>
                <input type="text" id="node-input-tstart_even" placeholder="t_start">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-col nr-db-text-layout-col-center">
                <label for="node-input-tend_even"><i class="icon-tag"></i>t_end</label>
                <input type="text" id="node-input-tend_even" placeholder="t_end">
            </a>
        </div>
        </div>
    </div>
    <div class="form-row">
        <label style="vertical-align: top"><i class="fa fa-th-large"></i> Night </label>
        <div style="display:inline-block">
        <input type="hidden" id="node-input-layout"><input type="hidden" id="node-input-layoutAlign">
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-left">
                <label for="node-input-mu_night"><i class="icon-tag"></i>mu</label>
                <input type="text" id="node-input-mu_night" placeholder="mu">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-center">
                <label for="node-input-sigma_night"><i class="icon-tag"></i>sigma</label>
                <input type="text" id="node-input-sigma_night" placeholder="sigma">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-right">
                <label for="node-input-k_night"><i class="icon-tag"></i>k</label>
                <input type="text" id="node-input-k_night" placeholder="k">
            </a>
        </div>
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-spread">
                <label for="node-input-tstart_night"><i class="icon-tag"></i>t_start</label>
                <input type="text" id="node-input-tstart_night" placeholder="t_start">
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-col nr-db-text-layout-col-center">
                <label for="node-input-tend_night"><i class="icon-tag"></i>t_end</label>
                <input type="text" id="node-input-tend_night" placeholder="t_end">
            </a>
        </div>
        </div>
    </div>
  </script>

  <style>
      .nr-db-text-layout {
          position:relative;
          display: inline-block;
          width: 90px;
          height: 60px;
          border-radius:3px;

          cursor:pointer;
          color: #666;
          margin-right: 10px;
          margin-bottom: 10px;
      }
      .nr-db-text-layout span {
          position: absolute;
      }
      .nr-db-text-layout-value {
          font-weight: bold;
      }
      .nr-db-text-layout-row span { top: 20px; }
      .nr-db-text-layout-row-left .nr-db-text-layout-label { left: 2px; }
      .nr-db-text-layout-row-left .nr-db-text-layout-value { left: 34px; }
      .nr-db-text-layout-row-spread .nr-db-text-layout-label { left: 2px; }
      .nr-db-text-layout-row-spread .nr-db-text-layout-value { right: 2px; }
      .nr-db-text-layout-row-center .nr-db-text-layout-label { left: 11px; }
      .nr-db-text-layout-row-center .nr-db-text-layout-value { right: 11px; }
      .nr-db-text-layout-row-right .nr-db-text-layout-label { right: 40px; }
      .nr-db-text-layout-row-right .nr-db-text-layout-value { right: 2px; }

      .nr-db-text-layout-col span { width: 90px;  text-align: center; left: 0px;}
      .nr-db-text-layout-col-center .nr-db-text-layout-label { top: 12px; }
      .nr-db-text-layout-col-center .nr-db-text-layout-value { top: 26px; }
  </style>

  <script type="text/x-red" data-help-name="extreme_value">
    <p>Generates noise following a Extreme Value Distribution depending on the periods of day, evening and night.</p>

  <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">timestamp</span>
        </dt>
        <dd> the message payload is the timestamp (current time) used to discriminate between day, evening and night periods. </dd>
    </dl>

   <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">json</span></dt>
        <dd>the message payload is a json frame ready to send via RESTful protocol (POST operation).</dd>
    </dl>

    <h3>Operation</h3>
    <p><code>Name</code> is used to rename the node.</p>
    <p><code>msg.payload</code> (timestamp) is used to select a time period: day, evening or night.</p>
    <p>For each time period, it is possible to set the start time <code>t_start</code> and the end time 
       <code>t_end</code> as well as the location <code>mu</code>, the scale <code>sigma</code> and the 
       shape <code>k</code> parameters of the Extreme Value Distribution.</p>

<h3>References</h3>
    <ul>
        <li><a>http://www.mathwave.com/articles/extreme-value-distributions.html</a> - Extreme Value Distributions</li>
    </ul>    
  </script>
